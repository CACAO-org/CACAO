<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>cacao: MANAGING MULTIPLE PROCESSES</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="cacao-logo-small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">cacao
   &#160;<span id="projectnumber">Release 0.1.03-dev</span>
   </div>
   <div id="projectbrief">Compute And Control For Adaptive Optics</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('page_cacao_managing_processes.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">MANAGING MULTIPLE PROCESSES </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Note: Here, a process can consist of any operation or set of operations, as defined by the user. In this appendix, a process does not strictly correspond to a CPU process.</p>
<p>cacao's bash script includes tools to manage logical links between processes. A process can be <b>queued</b>, waiting to start until some condition is met, and its status (running, waiting to be launched, or completed) can be checked.</p>
<p>The command <code>l</code> under the GUI top menu will launch a window displaying processes status.</p>
<h2>Queued process</h2>
<p>A queued process is a process that has been sent to a tmux session but is awaiting previous operations, within the same tmux session, to be completed. The process is logged as queued when the corresponding command is sent to the tmux session. When the tmux session reaches the command, it will move it from queued to active.</p>
<p>To log queued processes as such, follow this bash template: </p><pre class="fragment">logRunningProcessQ "&lt;process_tag&gt;" &lt;tmux_session_name&gt;
tmux send-keys -t &lt;tmux_session_name&gt; "process_command" C-m
</pre><p>or </p><pre class="fragment">logRunningProcessQ0 "&lt;process_tag&gt;" &lt;tmux_session_name&gt; "&lt;comments&gt;"
tmux send-keys -t &lt;tmux_session_name&gt; "mv runproc/&lt;process_tag&gt;.runprocQ runproc/&lt;process_tag&gt;.runproc" C-m
tmux send-keys -t &lt;tmux_session_name&gt; "process_command" C-m
</pre><p><code>process_tag</code> is a name chosen to represent the operations performed. The second option can be used when writing to a script, so it is more flexible.</p>
<h2>Active process</h2>
<p>To mark a process as active, it can either be queued as described above, or the user can include at the time the process starts: </p><pre class="fragment">touch runproc/&lt;process_tag&gt;.runproc
</pre><p>Once the process is completed, it needs to be removed from the active process list : </p><pre class="fragment">rm runproc/&lt;process_tag&gt;.runproc
</pre><h2>Locking/unlocking processes</h2>
<p>The command <code>./auxscripts/waitforfilek</code> in <code>&lt;srcdir&gt;/scripts</code> locks the bash script execution until a file <code>&lt;tagname&gt;.unlock</code> appears. The command will remove the unlock file once it appears, and continue execution. It can take a timeout option. Typical use: </p><pre class="fragment">tmux send-keys -t &lt;tmux_session_name&gt; "command_that_needs_to_be_completed_before_non-tmux_script_commands" C-m
tmux send-keys -t &lt;tmux_session_name&gt; "touch &lt;tagname&gt;.unlock" C-m  # command will unlock the script once the unlock file appears
./auxscripts/waitforfilek -t &lt;timeout_sec&gt; &lt;tagname&gt;
&lt;non-tmux_script_commands_to_be_executed_AFTER_tmux_commands&gt;
</pre><p>The command creates a "&lt;tagname&gt;.lock" file, and waits for a "&lt;tagname&gt;.unlock" to appear. When the unlock file is detected, both lock and unlock files are removed. The lock file indicates that a process is currently locked. This scheme can be employed to synchronize multiple scripts.</p>
<p>The lower level <code>./auxscripts/waitonfile</code> command allows users to manually setup locks between proceses, by waiting for a file to disappear. Typical use: </p><pre class="fragment">touch fname.lock
&lt;some other process here, will remove fname.lock file when done&gt;
./auxscripts/waitonfile fname.lock
&lt;more bash instructions here&gt;</pre> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="page_cacao_topmenu.html">Subpages</a></li><li class="navelem"><a class="el" href="page_cacao_top_guide.html">Configuring and Running cacao</a></li>
    <li class="footer">Generated on Tue Apr 7 2020 11:54:17 for cacao by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
